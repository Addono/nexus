{"expireTime":9007200846064370000,"key":"gatsby-plugin-mdx-entire-payload-939d17155101719fdd2e5431ebf6a1b4-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Chapter 5 ","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":13,"offset":13},"indent":[]}},{"type":"jsx","value":"<br/>","position":{"start":{"line":2,"column":13,"offset":13},"end":{"line":2,"column":18,"offset":18},"indent":[]}},{"type":"text","value":" Persisting Data (via Prisma)","position":{"start":{"line":2,"column":18,"offset":18},"end":{"line":2,"column":47,"offset":47},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":47,"offset":47},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"So far we have been working with in-memory data while we learn about other parts of Nexus in a focused manner, but in this chapter we're going to put the focus squarely on data and show how Nexus can be used with a database. This marks an important step toward your blog app becoming more real. You'll learn about:","position":{"start":{"line":4,"column":1,"offset":49},"end":{"line":4,"column":315,"offset":363},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":49},"end":{"line":4,"column":315,"offset":363},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Prisma","position":{"start":{"line":6,"column":3,"offset":367},"end":{"line":6,"column":9,"offset":373},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":367},"end":{"line":6,"column":9,"offset":373},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":365},"end":{"line":6,"column":9,"offset":373},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Nexus Plugins","position":{"start":{"line":7,"column":3,"offset":376},"end":{"line":7,"column":16,"offset":389},"indent":[]}}],"position":{"start":{"line":7,"column":3,"offset":376},"end":{"line":7,"column":16,"offset":389},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":374},"end":{"line":7,"column":16,"offset":389},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Setting up a Postgres database locally","position":{"start":{"line":8,"column":3,"offset":392},"end":{"line":8,"column":41,"offset":430},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":392},"end":{"line":8,"column":41,"offset":430},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":390},"end":{"line":8,"column":41,"offset":430},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":365},"end":{"line":8,"column":41,"offset":430},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"We're going to be using a database called Postgres and a tool called Prisma to interact with it.","position":{"start":{"line":10,"column":1,"offset":432},"end":{"line":10,"column":97,"offset":528},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":432},"end":{"line":10,"column":97,"offset":528},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Postgres is a well known open-source relational database. Prisma is a new way of working with databases that we'll learn more about in a moment.","position":{"start":{"line":12,"column":1,"offset":530},"end":{"line":12,"column":145,"offset":674},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":530},"end":{"line":12,"column":145,"offset":674},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Its important to understand that Nexus does not ","position":{"start":{"line":14,"column":1,"offset":676},"end":{"line":14,"column":49,"offset":724},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"require","position":{"start":{"line":14,"column":50,"offset":725},"end":{"line":14,"column":57,"offset":732},"indent":[]}}],"position":{"start":{"line":14,"column":49,"offset":724},"end":{"line":14,"column":58,"offset":733},"indent":[]}},{"type":"text","value":" these technology choices and ","position":{"start":{"line":14,"column":58,"offset":733},"end":{"line":14,"column":88,"offset":763},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"could","position":{"start":{"line":14,"column":89,"offset":764},"end":{"line":14,"column":94,"offset":769},"indent":[]}}],"position":{"start":{"line":14,"column":88,"offset":763},"end":{"line":14,"column":95,"offset":770},"indent":[]}},{"type":"text","value":" actually be used with any database and abstractions over them (raw SQL, query builder, ORM..). However, Nexus is built by a team at Prisma (the company) and unsurprisingly there is great integration between its tools and Nexus.","position":{"start":{"line":14,"column":95,"offset":770},"end":{"line":14,"column":323,"offset":998},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":676},"end":{"line":14,"column":323,"offset":998},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Prisma?","position":{"start":{"line":16,"column":4,"offset":1003},"end":{"line":16,"column":11,"offset":1010},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1000},"end":{"line":16,"column":11,"offset":1010},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"So, what ","position":{"start":{"line":18,"column":1,"offset":1012},"end":{"line":18,"column":10,"offset":1021},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"is","position":{"start":{"line":18,"column":11,"offset":1022},"end":{"line":18,"column":13,"offset":1024},"indent":[]}}],"position":{"start":{"line":18,"column":10,"offset":1021},"end":{"line":18,"column":14,"offset":1025},"indent":[]}},{"type":"text","value":" Prisma? It is an open source database toolkit that consists of the following parts:","position":{"start":{"line":18,"column":14,"offset":1025},"end":{"line":18,"column":98,"offset":1109},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1012},"end":{"line":18,"column":98,"offset":1109},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Prisma Client","position":{"start":{"line":20,"column":3,"offset":1113},"end":{"line":20,"column":16,"offset":1126},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1111},"end":{"line":20,"column":18,"offset":1128},"indent":[]}},{"type":"text","value":": Auto-generated and type-safe query builder for Node.js & TypeScript\n","position":{"start":{"line":20,"column":18,"offset":1128},"end":{"line":21,"column":1,"offset":1198},"indent":[1]}},{"type":"strong","children":[{"type":"text","value":"Prisma Migrate","position":{"start":{"line":21,"column":3,"offset":1200},"end":{"line":21,"column":17,"offset":1214},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":1198},"end":{"line":21,"column":19,"offset":1216},"indent":[]}},{"type":"text","value":" (experimental): Declarative data modeling & migration system\n","position":{"start":{"line":21,"column":19,"offset":1216},"end":{"line":22,"column":1,"offset":1278},"indent":[1]}},{"type":"strong","children":[{"type":"text","value":"Prisma Studio","position":{"start":{"line":22,"column":3,"offset":1280},"end":{"line":22,"column":16,"offset":1293},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1278},"end":{"line":22,"column":18,"offset":1295},"indent":[]}},{"type":"text","value":" (experimental): GUI to view and edit data in your database","position":{"start":{"line":22,"column":18,"offset":1295},"end":{"line":22,"column":77,"offset":1354},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1111},"end":{"line":22,"column":77,"offset":1354},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"At the heart of Prisma is the ","position":{"start":{"line":24,"column":1,"offset":1356},"end":{"line":24,"column":31,"offset":1386},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Prisma Schema,","position":{"start":{"line":24,"column":32,"offset":1387},"end":{"line":24,"column":46,"offset":1401},"indent":[]}}],"position":{"start":{"line":24,"column":31,"offset":1386},"end":{"line":24,"column":47,"offset":1402},"indent":[]}},{"type":"text","value":" a file usually called ","position":{"start":{"line":24,"column":47,"offset":1402},"end":{"line":24,"column":70,"offset":1425},"indent":[]}},{"type":"inlineCode","value":"schema.prisma","position":{"start":{"line":24,"column":70,"offset":1425},"end":{"line":24,"column":85,"offset":1440},"indent":[]}},{"type":"text","value":", that you will see later in this tutorial. It is a declarative file wherein using a domain specific language you encode your database schema, connection to the database, and more.","position":{"start":{"line":24,"column":85,"offset":1440},"end":{"line":24,"column":265,"offset":1620},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1356},"end":{"line":24,"column":265,"offset":1620},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Prisma has great ","position":{"start":{"line":26,"column":1,"offset":1622},"end":{"line":26,"column":18,"offset":1639},"indent":[]}},{"type":"link","title":null,"url":"https://www.prisma.io/docs/understand-prisma/introduction","children":[{"type":"text","value":"docs","position":{"start":{"line":26,"column":19,"offset":1640},"end":{"line":26,"column":23,"offset":1644},"indent":[]}}],"position":{"start":{"line":26,"column":18,"offset":1639},"end":{"line":26,"column":83,"offset":1704},"indent":[]}},{"type":"text","value":" so definitely check them out at some point. For now you can stay in the flow of this tutorial if you want though. We're going to focus on Prisma Client.","position":{"start":{"line":26,"column":83,"offset":1704},"end":{"line":26,"column":236,"offset":1857},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1622},"end":{"line":26,"column":236,"offset":1857},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Nexus plugins?","position":{"start":{"line":28,"column":4,"offset":1862},"end":{"line":28,"column":18,"offset":1876},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1859},"end":{"line":28,"column":18,"offset":1876},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Now we're ready to actually use Prisma with Nexus! This is going to be achieved by way of a Nexus ","position":{"start":{"line":30,"column":1,"offset":1878},"end":{"line":30,"column":99,"offset":1976},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"plugin","position":{"start":{"line":30,"column":100,"offset":1977},"end":{"line":30,"column":106,"offset":1983},"indent":[]}}],"position":{"start":{"line":30,"column":99,"offset":1976},"end":{"line":30,"column":107,"offset":1984},"indent":[]}},{"type":"text","value":". What? Yep, Nexus has a plugin ecosystem which can be used to enhance your app and development experience in a number of ways! Nexus Plugins broadly breakdown into three areas of enhancement:","position":{"start":{"line":30,"column":107,"offset":1984},"end":{"line":30,"column":299,"offset":2176},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1878},"end":{"line":30,"column":299,"offset":2176},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"worktime:","position":{"start":{"line":32,"column":6,"offset":2183},"end":{"line":32,"column":15,"offset":2192},"indent":[]}}],"position":{"start":{"line":32,"column":4,"offset":2181},"end":{"line":32,"column":17,"offset":2194},"indent":[]}},{"type":"text","value":" watch new file types, hook onto events, attach new CLI commands, ...","position":{"start":{"line":32,"column":17,"offset":2194},"end":{"line":32,"column":86,"offset":2263},"indent":[]}}],"position":{"start":{"line":32,"column":4,"offset":2181},"end":{"line":32,"column":86,"offset":2263},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":2178},"end":{"line":32,"column":86,"offset":2263},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"runtime:","position":{"start":{"line":33,"column":6,"offset":2269},"end":{"line":33,"column":14,"offset":2277},"indent":[]}}],"position":{"start":{"line":33,"column":4,"offset":2267},"end":{"line":33,"column":16,"offset":2279},"indent":[]}},{"type":"text","value":" add schema middleware, setting presets, field builders, custom scalars, ...","position":{"start":{"line":33,"column":16,"offset":2279},"end":{"line":33,"column":92,"offset":2355},"indent":[]}}],"position":{"start":{"line":33,"column":4,"offset":2267},"end":{"line":33,"column":92,"offset":2355},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":2264},"end":{"line":33,"column":92,"offset":2355},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"testtime:","position":{"start":{"line":34,"column":6,"offset":2361},"end":{"line":34,"column":15,"offset":2370},"indent":[]}}],"position":{"start":{"line":34,"column":4,"offset":2359},"end":{"line":34,"column":17,"offset":2372},"indent":[]}},{"type":"text","value":" attach data to the Nexus Test Context","position":{"start":{"line":34,"column":17,"offset":2372},"end":{"line":34,"column":55,"offset":2410},"indent":[]}}],"position":{"start":{"line":34,"column":4,"offset":2359},"end":{"line":34,"column":55,"offset":2410},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":2356},"end":{"line":34,"column":55,"offset":2410},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":2178},"end":{"line":34,"column":55,"offset":2410},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Plugin packages are usually named after the following convention: ","position":{"start":{"line":36,"column":1,"offset":2412},"end":{"line":36,"column":67,"offset":2478},"indent":[]}},{"type":"inlineCode","value":"nexus-plugin-<name>","position":{"start":{"line":36,"column":67,"offset":2478},"end":{"line":36,"column":88,"offset":2499},"indent":[]}},{"type":"text","value":" and we refer to them just by either name suffix part. So for the example when we say that Prisma and Nexus integrate together via the Nexus ","position":{"start":{"line":36,"column":88,"offset":2499},"end":{"line":36,"column":229,"offset":2640},"indent":[]}},{"type":"inlineCode","value":"prisma","position":{"start":{"line":36,"column":229,"offset":2640},"end":{"line":36,"column":237,"offset":2648},"indent":[]}},{"type":"text","value":" plugin that means ","position":{"start":{"line":36,"column":237,"offset":2648},"end":{"line":36,"column":256,"offset":2667},"indent":[]}},{"type":"inlineCode","value":"nexus-plugin-prisma","position":{"start":{"line":36,"column":256,"offset":2667},"end":{"line":36,"column":277,"offset":2688},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":36,"column":277,"offset":2688},"end":{"line":36,"column":278,"offset":2689},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":2412},"end":{"line":36,"column":278,"offset":2689},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Another convention that they usually follow is that they use the default export of the package as well as a named export that is a camel case variant of the name part mentioned before (see below for example).","position":{"start":{"line":38,"column":1,"offset":2691},"end":{"line":38,"column":209,"offset":2899},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":2691},"end":{"line":38,"column":209,"offset":2899},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Plugins are easy to use:","position":{"start":{"line":40,"column":1,"offset":2901},"end":{"line":40,"column":25,"offset":2925},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":2901},"end":{"line":40,"column":25,"offset":2925},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"npm add nexus-plugin-foo","position":{"start":{"line":42,"column":1,"offset":2927},"end":{"line":44,"column":4,"offset":2963},"indent":[1,1]}},{"type":"code","lang":"ts","meta":null,"value":"import foo from 'nexus-plugin-foo'\nimport { foo } from 'nexus-plugin-foo' // alternative, as you wish\nimport { use } from 'nexus'\n\nuse(foo())","position":{"start":{"line":46,"column":1,"offset":2965},"end":{"line":52,"column":4,"offset":3116},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"All plugins are functions. They can accept optional or required settings if the plugin authors wishes so. Once a plugin is imported and invoked, its return value is passed to the Nexus ","position":{"start":{"line":54,"column":1,"offset":3118},"end":{"line":54,"column":186,"offset":3303},"indent":[]}},{"type":"inlineCode","value":"use","position":{"start":{"line":54,"column":186,"offset":3303},"end":{"line":54,"column":191,"offset":3308},"indent":[]}},{"type":"text","value":" method. Once done, your app is using the plugin. On the surface the method looks similar to that of ","position":{"start":{"line":54,"column":191,"offset":3308},"end":{"line":54,"column":292,"offset":3409},"indent":[]}},{"type":"inlineCode","value":"express","position":{"start":{"line":54,"column":292,"offset":3409},"end":{"line":54,"column":301,"offset":3418},"indent":[]}},{"type":"text","value":"'s ","position":{"start":{"line":54,"column":301,"offset":3418},"end":{"line":54,"column":304,"offset":3421},"indent":[]}},{"type":"inlineCode","value":"use","position":{"start":{"line":54,"column":304,"offset":3421},"end":{"line":54,"column":309,"offset":3426},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":54,"column":309,"offset":3426},"end":{"line":54,"column":310,"offset":3427},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":3118},"end":{"line":54,"column":310,"offset":3427},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Note how the plugins only exist within your app code yet we mentioned before that plugins can augment worktime aspects like the CLI. Neat right? No external config files with plugin setup are required. Its one of many examples of how Nexus provides a powerful and extensible system without forwarding you, the user, a complexity tax for it.","position":{"start":{"line":56,"column":1,"offset":3429},"end":{"line":56,"column":341,"offset":3769},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":3429},"end":{"line":56,"column":341,"offset":3769},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Connect to your database","position":{"start":{"line":58,"column":4,"offset":3774},"end":{"line":58,"column":28,"offset":3798},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":3771},"end":{"line":58,"column":28,"offset":3798},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Now that you know a bit about Prisma and Nexus plugins, let's get going! Do the following:","position":{"start":{"line":60,"column":1,"offset":3800},"end":{"line":60,"column":91,"offset":3890},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":3800},"end":{"line":60,"column":91,"offset":3890},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Install the Prisma plugin","position":{"start":{"line":62,"column":3,"offset":3894},"end":{"line":62,"column":28,"offset":3919},"indent":[]}}],"position":{"start":{"line":62,"column":3,"offset":3894},"end":{"line":62,"column":28,"offset":3919},"indent":[]}}],"position":{"start":{"line":62,"column":1,"offset":3892},"end":{"line":62,"column":28,"offset":3919},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use it in your ","position":{"start":{"line":63,"column":3,"offset":3922},"end":{"line":63,"column":18,"offset":3937},"indent":[]}},{"type":"inlineCode","value":"api/app.ts","position":{"start":{"line":63,"column":18,"offset":3937},"end":{"line":63,"column":30,"offset":3949},"indent":[]}},{"type":"text","value":" module","position":{"start":{"line":63,"column":30,"offset":3949},"end":{"line":63,"column":37,"offset":3956},"indent":[]}}],"position":{"start":{"line":63,"column":3,"offset":3922},"end":{"line":63,"column":37,"offset":3956},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":3920},"end":{"line":63,"column":37,"offset":3956},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create your Prisma Schema","position":{"start":{"line":64,"column":3,"offset":3959},"end":{"line":64,"column":28,"offset":3984},"indent":[]}}],"position":{"start":{"line":64,"column":3,"offset":3959},"end":{"line":64,"column":28,"offset":3984},"indent":[]}}],"position":{"start":{"line":64,"column":1,"offset":3957},"end":{"line":64,"column":28,"offset":3984},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a ","position":{"start":{"line":65,"column":3,"offset":3987},"end":{"line":65,"column":12,"offset":3996},"indent":[]}},{"type":"inlineCode","value":".env","position":{"start":{"line":65,"column":12,"offset":3996},"end":{"line":65,"column":18,"offset":4002},"indent":[]}},{"type":"text","value":" file to store your database credentials","position":{"start":{"line":65,"column":18,"offset":4002},"end":{"line":65,"column":58,"offset":4042},"indent":[]}}],"position":{"start":{"line":65,"column":3,"offset":3987},"end":{"line":65,"column":58,"offset":4042},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":3985},"end":{"line":65,"column":58,"offset":4042},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Connect to your database","position":{"start":{"line":66,"column":3,"offset":4045},"end":{"line":66,"column":27,"offset":4069},"indent":[]}}],"position":{"start":{"line":66,"column":3,"offset":4045},"end":{"line":66,"column":27,"offset":4069},"indent":[]}}],"position":{"start":{"line":66,"column":1,"offset":4043},"end":{"line":66,"column":27,"offset":4069},"indent":[]}}],"position":{"start":{"line":62,"column":1,"offset":3892},"end":{"line":66,"column":27,"offset":4069},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"like so:","position":{"start":{"line":68,"column":1,"offset":4071},"end":{"line":68,"column":9,"offset":4079},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":4071},"end":{"line":68,"column":9,"offset":4079},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"npm add nexus-plugin-prisma","position":{"start":{"line":70,"column":1,"offset":4081},"end":{"line":72,"column":4,"offset":4120},"indent":[1,1]}},{"type":"code","lang":"ts","meta":null,"value":"// api/app.ts\n\nimport { use } from 'nexus'\nimport { prisma } from 'nexus-plugin-prisma'\n\nuse(prisma())","position":{"start":{"line":74,"column":1,"offset":4122},"end":{"line":81,"column":4,"offset":4234},"indent":[1,1,1,1,1,1,1]}},{"type":"code","lang":"bash","meta":null,"value":"mkdir prisma\ntouch prisma/schema.prisma\ntouch prisma/.env","position":{"start":{"line":83,"column":1,"offset":4236},"end":{"line":87,"column":4,"offset":4305},"indent":[1,1,1,1]}},{"type":"code","lang":"groovy","meta":null,"value":"// prisma/schema.prisma\n\ndatasource postgres {\n  provider = \"postgresql\"\n  url      = env(\"DATABASE_URL\")\n}","position":{"start":{"line":89,"column":1,"offset":4307},"end":{"line":96,"column":4,"offset":4428},"indent":[1,1,1,1,1,1,1]}},{"type":"code","lang":null,"meta":null,"value":"# prisma/.env\nDATABASE_URL=\"<postgres_connection_url>\"","position":{"start":{"line":98,"column":1,"offset":4430},"end":{"line":101,"column":4,"offset":4492},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Almost done, but we still need to setup a Postgres database for our app to connect to. There are a ton of ways to do this so we're just going to show the most straight forward cross-platform way we know how. First, make sure you have ","position":{"start":{"line":103,"column":1,"offset":4494},"end":{"line":103,"column":235,"offset":4728},"indent":[]}},{"type":"link","title":null,"url":"https://docs.docker.com/get-docker/","children":[{"type":"text","value":"docker installed","position":{"start":{"line":103,"column":236,"offset":4729},"end":{"line":103,"column":252,"offset":4745},"indent":[]}}],"position":{"start":{"line":103,"column":235,"offset":4728},"end":{"line":103,"column":290,"offset":4783},"indent":[]}},{"type":"text","value":". Then, simply run this command:","position":{"start":{"line":103,"column":290,"offset":4783},"end":{"line":103,"column":322,"offset":4815},"indent":[]}}],"position":{"start":{"line":103,"column":1,"offset":4494},"end":{"line":103,"column":322,"offset":4815},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"❯ docker run --detach --publish 5432:5432 -e POSTGRES_PASSWORD=postgres --name postgres postgres:10.12","position":{"start":{"line":105,"column":1,"offset":4817},"end":{"line":107,"column":4,"offset":4927},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"That's it. You now have a Postgres server running. You can connect to it at a URL like:","position":{"start":{"line":109,"column":1,"offset":4929},"end":{"line":109,"column":88,"offset":5016},"indent":[]}}],"position":{"start":{"line":109,"column":1,"offset":4929},"end":{"line":109,"column":88,"offset":5016},"indent":[]}},{"type":"code","lang":"markdown","meta":null,"value":"postgresql://postgres:postgres@localhost:5432/myapp","position":{"start":{"line":111,"column":1,"offset":5018},"end":{"line":113,"column":4,"offset":5085},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"If you prefer setting up your local Postgres another way go for it. If our suggest approach doesn't work for you, then checkout a few other approaches listed on the ","position":{"start":{"line":115,"column":1,"offset":5087},"end":{"line":115,"column":166,"offset":5252},"indent":[]}},{"type":"link","title":null,"url":"https://www.nexusjs.org/#/references/recipes?id=setting-up-postgresql","children":[{"type":"text","value":"Nexus recipes page","position":{"start":{"line":115,"column":167,"offset":5253},"end":{"line":115,"column":185,"offset":5271},"indent":[]}}],"position":{"start":{"line":115,"column":166,"offset":5252},"end":{"line":115,"column":257,"offset":5343},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":115,"column":257,"offset":5343},"end":{"line":115,"column":258,"offset":5344},"indent":[]}}],"position":{"start":{"line":115,"column":1,"offset":5087},"end":{"line":115,"column":258,"offset":5344},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Finally, in the ","position":{"start":{"line":117,"column":1,"offset":5346},"end":{"line":117,"column":17,"offset":5362},"indent":[]}},{"type":"inlineCode","value":"prisma/.env","position":{"start":{"line":117,"column":17,"offset":5362},"end":{"line":117,"column":30,"offset":5375},"indent":[]}},{"type":"text","value":" file you've created before, replace ","position":{"start":{"line":117,"column":30,"offset":5375},"end":{"line":117,"column":67,"offset":5412},"indent":[]}},{"type":"inlineCode","value":"<postgres_connection_url>","position":{"start":{"line":117,"column":67,"offset":5412},"end":{"line":117,"column":94,"offset":5439},"indent":[]}},{"type":"text","value":" with your actual database URL.","position":{"start":{"line":117,"column":94,"offset":5439},"end":{"line":117,"column":125,"offset":5470},"indent":[]}}],"position":{"start":{"line":117,"column":1,"offset":5346},"end":{"line":117,"column":125,"offset":5470},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Confirm things are setup correctly by ... ","position":{"start":{"line":119,"column":1,"offset":5472},"end":{"line":119,"column":43,"offset":5514},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"TODO: find a way to make sure their connection url is working","position":{"start":{"line":119,"column":45,"offset":5516},"end":{"line":119,"column":106,"offset":5577},"indent":[]}}],"position":{"start":{"line":119,"column":43,"offset":5514},"end":{"line":119,"column":108,"offset":5579},"indent":[]}}],"position":{"start":{"line":119,"column":1,"offset":5472},"end":{"line":119,"column":108,"offset":5579},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Create your database schema","position":{"start":{"line":121,"column":4,"offset":5584},"end":{"line":121,"column":31,"offset":5611},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":5581},"end":{"line":121,"column":31,"offset":5611},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"It is now time to replace our in-memory data with actual tables in our database. To do this we'll write models in our Prisma Schema.","position":{"start":{"line":123,"column":1,"offset":5613},"end":{"line":123,"column":133,"offset":5745},"indent":[]}}],"position":{"start":{"line":123,"column":1,"offset":5613},"end":{"line":123,"column":133,"offset":5745},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In chapters 2 and 3 we already began to model our blog domain with the GraphQL type ","position":{"start":{"line":125,"column":1,"offset":5747},"end":{"line":125,"column":85,"offset":5831},"indent":[]}},{"type":"inlineCode","value":"Post","position":{"start":{"line":125,"column":85,"offset":5831},"end":{"line":125,"column":91,"offset":5837},"indent":[]}},{"type":"text","value":". We can base our models on that prior work, resulting in a Prisma Schema like so:","position":{"start":{"line":125,"column":91,"offset":5837},"end":{"line":125,"column":173,"offset":5919},"indent":[]}}],"position":{"start":{"line":125,"column":1,"offset":5747},"end":{"line":125,"column":173,"offset":5919},"indent":[]}},{"type":"code","lang":"groovy","meta":null,"value":"// prisma/schema.prisma\n// ...\n\nmodel Post {\n  id        Int     @id @default(autoincrement())\n  title     String\n  body      String\n  published Boolean\n}","position":{"start":{"line":127,"column":1,"offset":5921},"end":{"line":137,"column":4,"offset":6089},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"With our database schema specified, we're now ready to proceed to our first database migration! To do that, we'll use the Prisma CLI.","position":{"start":{"line":139,"column":1,"offset":6091},"end":{"line":139,"column":134,"offset":6224},"indent":[]}}],"position":{"start":{"line":139,"column":1,"offset":6091},"end":{"line":139,"column":134,"offset":6224},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Generate our migration files...","position":{"start":{"line":141,"column":1,"offset":6226},"end":{"line":141,"column":32,"offset":6257},"indent":[]}}],"position":{"start":{"line":141,"column":1,"offset":6226},"end":{"line":141,"column":32,"offset":6257},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"npx prisma migrate save --experimental","position":{"start":{"line":143,"column":1,"offset":6259},"end":{"line":145,"column":4,"offset":6309},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Then, apply the migration...","position":{"start":{"line":147,"column":1,"offset":6311},"end":{"line":147,"column":29,"offset":6339},"indent":[]}}],"position":{"start":{"line":147,"column":1,"offset":6311},"end":{"line":147,"column":29,"offset":6339},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"npx prisma migrate up --experimental","position":{"start":{"line":149,"column":1,"offset":6341},"end":{"line":151,"column":4,"offset":6389},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Access your database","position":{"start":{"line":153,"column":4,"offset":6394},"end":{"line":153,"column":24,"offset":6414},"indent":[]}}],"position":{"start":{"line":153,"column":1,"offset":6391},"end":{"line":153,"column":24,"offset":6414},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Now let's finally ditch our in-memory data! Let's start by removing the ","position":{"start":{"line":155,"column":1,"offset":6416},"end":{"line":155,"column":73,"offset":6488},"indent":[]}},{"type":"inlineCode","value":"api/db.ts","position":{"start":{"line":155,"column":73,"offset":6488},"end":{"line":155,"column":84,"offset":6499},"indent":[]}},{"type":"text","value":" module and then be guided by TypeScript errors.","position":{"start":{"line":155,"column":84,"offset":6499},"end":{"line":155,"column":132,"offset":6547},"indent":[]}}],"position":{"start":{"line":155,"column":1,"offset":6416},"end":{"line":155,"column":132,"offset":6547},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"rm api/db.ts","position":{"start":{"line":157,"column":1,"offset":6549},"end":{"line":159,"column":4,"offset":6573},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In ","position":{"start":{"line":161,"column":1,"offset":6575},"end":{"line":161,"column":4,"offset":6578},"indent":[]}},{"type":"inlineCode","value":"api/app.ts","position":{"start":{"line":161,"column":4,"offset":6578},"end":{"line":161,"column":16,"offset":6590},"indent":[]}},{"type":"text","value":" module, remove the db import and the ","position":{"start":{"line":161,"column":16,"offset":6590},"end":{"line":161,"column":54,"offset":6628},"indent":[]}},{"type":"inlineCode","value":"schema.addToContext","position":{"start":{"line":161,"column":54,"offset":6628},"end":{"line":161,"column":75,"offset":6649},"indent":[]}},{"type":"text","value":" call.","position":{"start":{"line":161,"column":75,"offset":6649},"end":{"line":161,"column":81,"offset":6655},"indent":[]}}],"position":{"start":{"line":161,"column":1,"offset":6575},"end":{"line":161,"column":81,"offset":6655},"indent":[]}},{"type":"code","lang":"diff","meta":null,"value":"+++ api/app.ts\n\n- import { schema, use } from 'nexus'\n+ import { use } from 'nexus'\n  import { prisma } from 'nexus-plugin-prisma'\n- import { db } from './db'\n\n  use(prisma())\n\n- schema.addToContext(() => {\n-   return {\n-     db,\n-   }\n- })","position":{"start":{"line":163,"column":1,"offset":6657},"end":{"line":178,"column":4,"offset":6909},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"You might be wondering how you'll maintain access to the ","position":{"start":{"line":180,"column":1,"offset":6911},"end":{"line":180,"column":58,"offset":6968},"indent":[]}},{"type":"inlineCode","value":"db","position":{"start":{"line":180,"column":58,"offset":6968},"end":{"line":180,"column":62,"offset":6972},"indent":[]}},{"type":"text","value":" client in your GraphQL Context given that we've just deleted it. Nexus plugins help here. One of their many capabilities is augmenting your GraphQL context.","position":{"start":{"line":180,"column":62,"offset":6972},"end":{"line":180,"column":219,"offset":7129},"indent":[]}}],"position":{"start":{"line":180,"column":1,"offset":6911},"end":{"line":180,"column":219,"offset":7129},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In this case, the prisma plugin adds a ","position":{"start":{"line":182,"column":1,"offset":7131},"end":{"line":182,"column":40,"offset":7170},"indent":[]}},{"type":"inlineCode","value":"db","position":{"start":{"line":182,"column":40,"offset":7170},"end":{"line":182,"column":44,"offset":7174},"indent":[]}},{"type":"text","value":" property, an instance of Prisma Client, one of the tools in the Prisma toolkit.","position":{"start":{"line":182,"column":44,"offset":7174},"end":{"line":182,"column":124,"offset":7254},"indent":[]}}],"position":{"start":{"line":182,"column":1,"offset":7131},"end":{"line":182,"column":124,"offset":7254},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Let's now replace all our previous in-memory db interactions with calls to the Prisma Client","position":{"start":{"line":184,"column":1,"offset":7256},"end":{"line":184,"column":93,"offset":7348},"indent":[]}}],"position":{"start":{"line":184,"column":1,"offset":7256},"end":{"line":184,"column":93,"offset":7348},"indent":[]}},{"type":"code","lang":"diff","meta":null,"value":"schema.extendType({\n  type: 'Query',\n  definition(t) {\n    t.list.field('drafts', {\n      type: 'Post',\n      resolve(_root, _args, ctx) {\n-        return ctx.db.posts.filter((p) => p.published === false)\n+        return ctx.db.post.findMany({ where: { published: false } })\n      },\n    });\n    t.list.field('posts', {\n      type: 'Post',\n      resolve(_root, _args, ctx) {\n-       return ctx.db.posts.filter((p) => p.published === true)\n+       return ctx.db.post.findMany({ where: { published: true } })\n      },\n    })\n  },\n});","position":{"start":{"line":186,"column":1,"offset":7350},"end":{"line":206,"column":4,"offset":7893},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"diff","meta":null,"value":"schema.extendType({\n  type: 'Mutation',\n  definition(t) {\n    t.field('createDraft', {\n      type: 'Post',\n      args: {\n        title: schema.stringArg({ required: true }),\n        body: schema.stringArg({ required: true }),\n      },\n      resolve(_root, args, ctx) {\n        const draft = {\n-         id: ctx.inDb.posts.length + 1,\n          title: args.title,\n          body: args.body,\n          published: false,\n        }\n-       ctx.inDb.posts.push(draft)\n\n-       return draft\n+       return ctx.db.post.create({ data: draft })\n      },\n    })\n\n    t.field('publish', {\n      type: 'Post',\n      args: {\n        draftId: schema.intArg({ required: true }),\n      },\n      resolve(_root, args, ctx) {\n-       let postToPublish = ctx.inDb.posts.find((p) => p.id === args.draftId)\n\n-       if (!postToPublish) {\n-         throw new Error('Could not find draft with id ' + args.draftId)\n-       }\n\n-       postToPublish.published = true\n\n-       return postToPublish\n\n+       return ctx.db.post.update({\n+         where: { id: args.draftId },\n+         data: {\n+           published: true,\n+         },\n+       });\n      },\n    })\n  },\n})","position":{"start":{"line":208,"column":1,"offset":7895},"end":{"line":258,"column":4,"offset":9048},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"If you need a copy & pastable version, here it is","position":{"start":{"line":260,"column":1,"offset":9050},"end":{"line":260,"column":50,"offset":9099},"indent":[]}}],"position":{"start":{"line":260,"column":1,"offset":9050},"end":{"line":260,"column":50,"offset":9099},"indent":[]}},{"type":"code","lang":"ts","meta":null,"value":"schema.extendType({\n  type: 'Query',\n  definition(t) {\n    t.list.field('drafts', {\n      type: 'Post',\n      resolve(_root, _args, ctx) {\n        return ctx.db.post.findMany({ where: { published: false } })\n      },\n    })\n    t.list.field('posts', {\n      type: 'Post',\n      resolve(_root, _args, ctx) {\n        return ctx.db.post.findMany({ where: { published: true } })\n      },\n    })\n  },\n})\n\nschema.extendType({\n  type: 'Mutation',\n  definition(t) {\n    t.field('createDraft', {\n      type: 'Post',\n      args: {\n        title: schema.stringArg({ required: true }),\n        body: schema.stringArg({ required: true }),\n      },\n      resolve(_root, args, ctx) {\n        const draft = {\n          title: args.title,\n          body: args.body,\n          published: false,\n        }\n        return ctx.db.post.create({ data: draft })\n      },\n    })\n\n    t.field('publish', {\n      type: 'Post',\n      args: {\n        draftId: schema.intArg({ required: true }),\n      },\n      resolve(_root, args, ctx) {\n        return ctx.db.post.update({\n          where: { id: args.draftId },\n          data: {\n            published: true,\n          },\n        })\n      },\n    })\n  },\n})","position":{"start":{"line":262,"column":1,"offset":9101},"end":{"line":316,"column":4,"offset":10289},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Try It Out","position":{"start":{"line":318,"column":4,"offset":10294},"end":{"line":318,"column":14,"offset":10304},"indent":[]}}],"position":{"start":{"line":318,"column":1,"offset":10291},"end":{"line":318,"column":14,"offset":10304},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Awesome, you're ready to open up the playground and create a draft! If all goes well, good job! If not, no worries, there's a lot of integration pieces in this chapter where something could have gone wrong. If after reviewing your steps you still don't understand the issue, feel free to open up a ","position":{"start":{"line":320,"column":1,"offset":10306},"end":{"line":320,"column":299,"offset":10604},"indent":[]}},{"type":"link","title":null,"url":"https://nxs.li/discussions","children":[{"type":"text","value":"discussion","position":{"start":{"line":320,"column":300,"offset":10605},"end":{"line":320,"column":310,"offset":10615},"indent":[]}}],"position":{"start":{"line":320,"column":299,"offset":10604},"end":{"line":320,"column":339,"offset":10644},"indent":[]}},{"type":"text","value":" asking for help.","position":{"start":{"line":320,"column":339,"offset":10644},"end":{"line":320,"column":356,"offset":10661},"indent":[]}}],"position":{"start":{"line":320,"column":1,"offset":10306},"end":{"line":320,"column":356,"offset":10661},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Wrapping Up","position":{"start":{"line":322,"column":4,"offset":10666},"end":{"line":322,"column":15,"offset":10677},"indent":[]}}],"position":{"start":{"line":322,"column":1,"offset":10663},"end":{"line":322,"column":15,"offset":10677},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"We've just changed our code, so we must be due or overdue for a test update right? Well, in the next chapter we'll do just that, and show you how Nexus testing works with Prisma.","position":{"start":{"line":324,"column":1,"offset":10679},"end":{"line":324,"column":179,"offset":10857},"indent":[]}}],"position":{"start":{"line":324,"column":1,"offset":10679},"end":{"line":324,"column":179,"offset":10857},"indent":[]}},{"type":"jsx","value":"<div class=\"NextIs NextChapter\"></div>","position":{"start":{"line":326,"column":1,"offset":10859},"end":{"line":326,"column":39,"offset":10897},"indent":[]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"/tutorial/chapter-6-testing-with-prisma","children":[{"type":"text","value":"➳","position":{"start":{"line":328,"column":2,"offset":10900},"end":{"line":328,"column":3,"offset":10901},"indent":[]}}],"position":{"start":{"line":328,"column":1,"offset":10899},"end":{"line":328,"column":45,"offset":10943},"indent":[]}}],"position":{"start":{"line":328,"column":1,"offset":10899},"end":{"line":328,"column":45,"offset":10943},"indent":[]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"5. Persisting Data (via Prisma)\",\"metaDescription\":\"TODO\"}","position":{"start":{"line":331,"column":1,"offset":10946},"end":{"line":331,"column":97,"offset":11042},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":331,"column":97,"offset":11042}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"5. Persisting Data (via Prisma)\",\n  \"metaDescription\": \"TODO\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"section\", null, mdx(\"h1\", _extends({\n    parentName: \"section\"\n  }, {\n    \"id\": \"chapter-5-br-persisting-data-via-prisma\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }), mdx(\"a\", _extends({\n    parentName: \"h1\"\n  }, {\n    \"href\": \"#chapter-5-br-persisting-data-via-prisma\",\n    \"aria-label\": \"chapter 5 br persisting data via prisma permalink\",\n    \"className\": \"title-link before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"width\": \"17\",\n    \"height\": \"18\",\n    \"viewBox\": \"0 0 17 18\",\n    \"fill\": \"none\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  }), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 6.33337H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 11.6666H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M6.75 1L5 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M12 1L10.25 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \")), \"Chapter 5 \", mdx(\"br\", null), \" Persisting Data (via Prisma)\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"So far we have been working with in-memory data while we learn about other parts of Nexus in a focused manner, but in this chapter we're going to put the focus squarely on data and show how Nexus can be used with a database. This marks an important step toward your blog app becoming more real. You'll learn about:\"), mdx(\"ul\", {\n    parentName: \"section\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Prisma\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Nexus Plugins\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Setting up a Postgres database locally\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"We're going to be using a database called Postgres and a tool called Prisma to interact with it.\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Postgres is a well known open-source relational database. Prisma is a new way of working with databases that we'll learn more about in a moment.\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Its important to understand that Nexus does not \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"require\"), \" these technology choices and \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"could\"), \" actually be used with any database and abstractions over them (raw SQL, query builder, ORM..). However, Nexus is built by a team at Prisma (the company) and unsurprisingly there is great integration between its tools and Nexus.\"), mdx(\"section\", {\n    parentName: \"section\"\n  }, mdx(\"h2\", _extends({\n    parentName: \"section\"\n  }, {\n    \"id\": \"prisma\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }), mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#prisma\",\n    \"aria-label\": \"prisma permalink\",\n    \"className\": \"title-link before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"width\": \"17\",\n    \"height\": \"18\",\n    \"viewBox\": \"0 0 17 18\",\n    \"fill\": \"none\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  }), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 6.33337H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 11.6666H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M6.75 1L5 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M12 1L10.25 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \")), \"Prisma?\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"So, what \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"is\"), \" Prisma? It is an open source database toolkit that consists of the following parts:\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Prisma Client\"), \": Auto-generated and type-safe query builder for Node.js & TypeScript\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Prisma Migrate\"), \" (experimental): Declarative data modeling & migration system\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Prisma Studio\"), \" (experimental): GUI to view and edit data in your database\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"At the heart of Prisma is the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Prisma Schema,\"), \" a file usually called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"schema.prisma\"), \", that you will see later in this tutorial. It is a declarative file wherein using a domain specific language you encode your database schema, connection to the database, and more.\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Prisma has great \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.prisma.io/docs/understand-prisma/introduction\"\n  }), \"docs\"), \" so definitely check them out at some point. For now you can stay in the flow of this tutorial if you want though. We're going to focus on Prisma Client.\")), mdx(\"section\", {\n    parentName: \"section\"\n  }, mdx(\"h2\", _extends({\n    parentName: \"section\"\n  }, {\n    \"id\": \"nexus-plugins\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }), mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#nexus-plugins\",\n    \"aria-label\": \"nexus plugins permalink\",\n    \"className\": \"title-link before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"width\": \"17\",\n    \"height\": \"18\",\n    \"viewBox\": \"0 0 17 18\",\n    \"fill\": \"none\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  }), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 6.33337H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 11.6666H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M6.75 1L5 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M12 1L10.25 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \")), \"Nexus plugins?\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Now we're ready to actually use Prisma with Nexus! This is going to be achieved by way of a Nexus \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"plugin\"), \". What? Yep, Nexus has a plugin ecosystem which can be used to enhance your app and development experience in a number of ways! Nexus Plugins broadly breakdown into three areas of enhancement:\"), mdx(\"ol\", {\n    parentName: \"section\"\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"worktime:\"), \" watch new file types, hook onto events, attach new CLI commands, ...\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"runtime:\"), \" add schema middleware, setting presets, field builders, custom scalars, ...\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"testtime:\"), \" attach data to the Nexus Test Context\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Plugin packages are usually named after the following convention: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"nexus-plugin-<name>\"), \" and we refer to them just by either name suffix part. So for the example when we say that Prisma and Nexus integrate together via the Nexus \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"prisma\"), \" plugin that means \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"nexus-plugin-prisma\"), \".\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Another convention that they usually follow is that they use the default export of the package as well as a named export that is a camel case variant of the name part mentioned before (see below for example).\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Plugins are easy to use:\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"npm add nexus-plugin-foo\\n\")), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\"\n  }), \"import foo from 'nexus-plugin-foo'\\nimport { foo } from 'nexus-plugin-foo' // alternative, as you wish\\nimport { use } from 'nexus'\\n\\nuse(foo())\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"All plugins are functions. They can accept optional or required settings if the plugin authors wishes so. Once a plugin is imported and invoked, its return value is passed to the Nexus \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"use\"), \" method. Once done, your app is using the plugin. On the surface the method looks similar to that of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"express\"), \"'s \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"use\"), \".\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Note how the plugins only exist within your app code yet we mentioned before that plugins can augment worktime aspects like the CLI. Neat right? No external config files with plugin setup are required. Its one of many examples of how Nexus provides a powerful and extensible system without forwarding you, the user, a complexity tax for it.\")), mdx(\"section\", {\n    parentName: \"section\"\n  }, mdx(\"h2\", _extends({\n    parentName: \"section\"\n  }, {\n    \"id\": \"connect-to-your-database\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }), mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#connect-to-your-database\",\n    \"aria-label\": \"connect to your database permalink\",\n    \"className\": \"title-link before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"width\": \"17\",\n    \"height\": \"18\",\n    \"viewBox\": \"0 0 17 18\",\n    \"fill\": \"none\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  }), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 6.33337H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 11.6666H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M6.75 1L5 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M12 1L10.25 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \")), \"Connect to your database\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Now that you know a bit about Prisma and Nexus plugins, let's get going! Do the following:\"), mdx(\"ul\", {\n    parentName: \"section\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Install the Prisma plugin\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Use it in your \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"api/app.ts\"), \" module\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Create your Prisma Schema\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Create a \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".env\"), \" file to store your database credentials\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Connect to your database\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"like so:\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"npm add nexus-plugin-prisma\\n\")), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\"\n  }), \"// api/app.ts\\n\\nimport { use } from 'nexus'\\nimport { prisma } from 'nexus-plugin-prisma'\\n\\nuse(prisma())\\n\")), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"mkdir prisma\\ntouch prisma/schema.prisma\\ntouch prisma/.env\\n\")), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-groovy\"\n  }), \"// prisma/schema.prisma\\n\\ndatasource postgres {\\n  provider = \\\"postgresql\\\"\\n  url      = env(\\\"DATABASE_URL\\\")\\n}\\n\")), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"# prisma/.env\\nDATABASE_URL=\\\"<postgres_connection_url>\\\"\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Almost done, but we still need to setup a Postgres database for our app to connect to. There are a ton of ways to do this so we're just going to show the most straight forward cross-platform way we know how. First, make sure you have \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.docker.com/get-docker/\"\n  }), \"docker installed\"), \". Then, simply run this command:\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u276F docker run --detach --publish 5432:5432 -e POSTGRES_PASSWORD=postgres --name postgres postgres:10.12\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"That's it. You now have a Postgres server running. You can connect to it at a URL like:\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-markdown\"\n  }), \"postgresql://postgres:postgres@localhost:5432/myapp\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"If you prefer setting up your local Postgres another way go for it. If our suggest approach doesn't work for you, then checkout a few other approaches listed on the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.nexusjs.org/#/references/recipes?id=setting-up-postgresql\"\n  }), \"Nexus recipes page\"), \".\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Finally, in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"prisma/.env\"), \" file you've created before, replace \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<postgres_connection_url>\"), \" with your actual database URL.\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Confirm things are setup correctly by ... \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"TODO: find a way to make sure their connection url is working\"))), mdx(\"section\", {\n    parentName: \"section\"\n  }, mdx(\"h2\", _extends({\n    parentName: \"section\"\n  }, {\n    \"id\": \"create-your-database-schema\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }), mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#create-your-database-schema\",\n    \"aria-label\": \"create your database schema permalink\",\n    \"className\": \"title-link before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"width\": \"17\",\n    \"height\": \"18\",\n    \"viewBox\": \"0 0 17 18\",\n    \"fill\": \"none\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  }), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 6.33337H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 11.6666H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M6.75 1L5 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M12 1L10.25 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \")), \"Create your database schema\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"It is now time to replace our in-memory data with actual tables in our database. To do this we'll write models in our Prisma Schema.\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"In chapters 2 and 3 we already began to model our blog domain with the GraphQL type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Post\"), \". We can base our models on that prior work, resulting in a Prisma Schema like so:\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-groovy\"\n  }), \"// prisma/schema.prisma\\n// ...\\n\\nmodel Post {\\n  id        Int     @id @default(autoincrement())\\n  title     String\\n  body      String\\n  published Boolean\\n}\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"With our database schema specified, we're now ready to proceed to our first database migration! To do that, we'll use the Prisma CLI.\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Generate our migration files...\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"npx prisma migrate save --experimental\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Then, apply the migration...\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"npx prisma migrate up --experimental\\n\"))), mdx(\"section\", {\n    parentName: \"section\"\n  }, mdx(\"h2\", _extends({\n    parentName: \"section\"\n  }, {\n    \"id\": \"access-your-database\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }), mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#access-your-database\",\n    \"aria-label\": \"access your database permalink\",\n    \"className\": \"title-link before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"width\": \"17\",\n    \"height\": \"18\",\n    \"viewBox\": \"0 0 17 18\",\n    \"fill\": \"none\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  }), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 6.33337H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 11.6666H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M6.75 1L5 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M12 1L10.25 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \")), \"Access your database\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Now let's finally ditch our in-memory data! Let's start by removing the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"api/db.ts\"), \" module and then be guided by TypeScript errors.\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"rm api/db.ts\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"In \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"api/app.ts\"), \" module, remove the db import and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"schema.addToContext\"), \" call.\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-diff\"\n  }), \"+++ api/app.ts\\n\\n- import { schema, use } from 'nexus'\\n+ import { use } from 'nexus'\\n  import { prisma } from 'nexus-plugin-prisma'\\n- import { db } from './db'\\n\\n  use(prisma())\\n\\n- schema.addToContext(() => {\\n-   return {\\n-     db,\\n-   }\\n- })\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"You might be wondering how you'll maintain access to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"db\"), \" client in your GraphQL Context given that we've just deleted it. Nexus plugins help here. One of their many capabilities is augmenting your GraphQL context.\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"In this case, the prisma plugin adds a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"db\"), \" property, an instance of Prisma Client, one of the tools in the Prisma toolkit.\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Let's now replace all our previous in-memory db interactions with calls to the Prisma Client\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-diff\"\n  }), \"schema.extendType({\\n  type: 'Query',\\n  definition(t) {\\n    t.list.field('drafts', {\\n      type: 'Post',\\n      resolve(_root, _args, ctx) {\\n-        return ctx.db.posts.filter((p) => p.published === false)\\n+        return ctx.db.post.findMany({ where: { published: false } })\\n      },\\n    });\\n    t.list.field('posts', {\\n      type: 'Post',\\n      resolve(_root, _args, ctx) {\\n-       return ctx.db.posts.filter((p) => p.published === true)\\n+       return ctx.db.post.findMany({ where: { published: true } })\\n      },\\n    })\\n  },\\n});\\n\")), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-diff\"\n  }), \"schema.extendType({\\n  type: 'Mutation',\\n  definition(t) {\\n    t.field('createDraft', {\\n      type: 'Post',\\n      args: {\\n        title: schema.stringArg({ required: true }),\\n        body: schema.stringArg({ required: true }),\\n      },\\n      resolve(_root, args, ctx) {\\n        const draft = {\\n-         id: ctx.inDb.posts.length + 1,\\n          title: args.title,\\n          body: args.body,\\n          published: false,\\n        }\\n-       ctx.inDb.posts.push(draft)\\n\\n-       return draft\\n+       return ctx.db.post.create({ data: draft })\\n      },\\n    })\\n\\n    t.field('publish', {\\n      type: 'Post',\\n      args: {\\n        draftId: schema.intArg({ required: true }),\\n      },\\n      resolve(_root, args, ctx) {\\n-       let postToPublish = ctx.inDb.posts.find((p) => p.id === args.draftId)\\n\\n-       if (!postToPublish) {\\n-         throw new Error('Could not find draft with id ' + args.draftId)\\n-       }\\n\\n-       postToPublish.published = true\\n\\n-       return postToPublish\\n\\n+       return ctx.db.post.update({\\n+         where: { id: args.draftId },\\n+         data: {\\n+           published: true,\\n+         },\\n+       });\\n      },\\n    })\\n  },\\n})\\n\")), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"If you need a copy & pastable version, here it is\"), mdx(\"pre\", {\n    parentName: \"section\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\"\n  }), \"schema.extendType({\\n  type: 'Query',\\n  definition(t) {\\n    t.list.field('drafts', {\\n      type: 'Post',\\n      resolve(_root, _args, ctx) {\\n        return ctx.db.post.findMany({ where: { published: false } })\\n      },\\n    })\\n    t.list.field('posts', {\\n      type: 'Post',\\n      resolve(_root, _args, ctx) {\\n        return ctx.db.post.findMany({ where: { published: true } })\\n      },\\n    })\\n  },\\n})\\n\\nschema.extendType({\\n  type: 'Mutation',\\n  definition(t) {\\n    t.field('createDraft', {\\n      type: 'Post',\\n      args: {\\n        title: schema.stringArg({ required: true }),\\n        body: schema.stringArg({ required: true }),\\n      },\\n      resolve(_root, args, ctx) {\\n        const draft = {\\n          title: args.title,\\n          body: args.body,\\n          published: false,\\n        }\\n        return ctx.db.post.create({ data: draft })\\n      },\\n    })\\n\\n    t.field('publish', {\\n      type: 'Post',\\n      args: {\\n        draftId: schema.intArg({ required: true }),\\n      },\\n      resolve(_root, args, ctx) {\\n        return ctx.db.post.update({\\n          where: { id: args.draftId },\\n          data: {\\n            published: true,\\n          },\\n        })\\n      },\\n    })\\n  },\\n})\\n\"))), mdx(\"section\", {\n    parentName: \"section\"\n  }, mdx(\"h2\", _extends({\n    parentName: \"section\"\n  }, {\n    \"id\": \"try-it-out\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }), mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#try-it-out\",\n    \"aria-label\": \"try it out permalink\",\n    \"className\": \"title-link before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"width\": \"17\",\n    \"height\": \"18\",\n    \"viewBox\": \"0 0 17 18\",\n    \"fill\": \"none\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  }), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 6.33337H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 11.6666H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M6.75 1L5 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M12 1L10.25 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \")), \"Try It Out\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"Awesome, you're ready to open up the playground and create a draft! If all goes well, good job! If not, no worries, there's a lot of integration pieces in this chapter where something could have gone wrong. If after reviewing your steps you still don't understand the issue, feel free to open up a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nxs.li/discussions\"\n  }), \"discussion\"), \" asking for help.\")), mdx(\"section\", {\n    parentName: \"section\"\n  }, mdx(\"h2\", _extends({\n    parentName: \"section\"\n  }, {\n    \"id\": \"wrapping-up\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }), mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#wrapping-up\",\n    \"aria-label\": \"wrapping up permalink\",\n    \"className\": \"title-link before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"width\": \"17\",\n    \"height\": \"18\",\n    \"viewBox\": \"0 0 17 18\",\n    \"fill\": \"none\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  }), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 6.33337H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M1.5 11.6666H15.5\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M6.75 1L5 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \", mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"d\": \"M12 1L10.25 17\",\n    \"stroke\": \"#CBD5E0\",\n    \"strokeWidth\": \"2\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\"\n  })), \"\\n      \")), \"Wrapping Up\"), mdx(\"p\", {\n    parentName: \"section\"\n  }, \"We've just changed our code, so we must be due or overdue for a test update right? Well, in the next chapter we'll do just that, and show you how Nexus testing works with Prisma.\"), mdx(\"div\", {\n    className: \"NextIs NextChapter\"\n  }), mdx(\"p\", {\n    parentName: \"section\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/tutorial/chapter-6-testing-with-prisma\"\n  }), \"\\u27B3\")))));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"5. Persisting Data (via Prisma)\",\n  \"metaDescription\": \"TODO\"\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <section><h1 parentName=\"section\" {...{\n        \"id\": \"chapter-5-br-persisting-data-via-prisma\",\n        \"style\": {\n          \"position\": \"relative\"\n        }\n      }}><a parentName=\"h1\" {...{\n          \"href\": \"#chapter-5-br-persisting-data-via-prisma\",\n          \"aria-label\": \"chapter 5 br persisting data via prisma permalink\",\n          \"className\": \"title-link before\"\n        }}><svg parentName=\"a\" {...{\n            \"width\": \"17\",\n            \"height\": \"18\",\n            \"viewBox\": \"0 0 17 18\",\n            \"fill\": \"none\",\n            \"xmlns\": \"http://www.w3.org/2000/svg\"\n          }}>{`\n      `}<path parentName=\"svg\" {...{\n              \"d\": \"M1.5 6.33337H15.5\",\n              \"stroke\": \"#CBD5E0\",\n              \"strokeWidth\": \"2\",\n              \"strokeLineCap\": \"round\",\n              \"strokeLineJoin\": \"round\"\n            }}></path>{`\n      `}<path parentName=\"svg\" {...{\n              \"d\": \"M1.5 11.6666H15.5\",\n              \"stroke\": \"#CBD5E0\",\n              \"strokeWidth\": \"2\",\n              \"strokeLineCap\": \"round\",\n              \"strokeLineJoin\": \"round\"\n            }}></path>{`\n      `}<path parentName=\"svg\" {...{\n              \"d\": \"M6.75 1L5 17\",\n              \"stroke\": \"#CBD5E0\",\n              \"strokeWidth\": \"2\",\n              \"strokeLineCap\": \"round\",\n              \"strokeLineJoin\": \"round\"\n            }}></path>{`\n      `}<path parentName=\"svg\" {...{\n              \"d\": \"M12 1L10.25 17\",\n              \"stroke\": \"#CBD5E0\",\n              \"strokeWidth\": \"2\",\n              \"strokeLineCap\": \"round\",\n              \"strokeLineJoin\": \"round\"\n            }}></path>{`\n      `}</svg></a>{`Chapter 5 `}<br />{` Persisting Data (via Prisma)`}</h1><p parentName=\"section\">{`So far we have been working with in-memory data while we learn about other parts of Nexus in a focused manner, but in this chapter we're going to put the focus squarely on data and show how Nexus can be used with a database. This marks an important step toward your blog app becoming more real. You'll learn about:`}</p><ul parentName=\"section\">\n        <li parentName=\"ul\">{`Prisma`}</li>\n        <li parentName=\"ul\">{`Nexus Plugins`}</li>\n        <li parentName=\"ul\">{`Setting up a Postgres database locally`}</li>\n      </ul><p parentName=\"section\">{`We're going to be using a database called Postgres and a tool called Prisma to interact with it.`}</p><p parentName=\"section\">{`Postgres is a well known open-source relational database. Prisma is a new way of working with databases that we'll learn more about in a moment.`}</p><p parentName=\"section\">{`Its important to understand that Nexus does not `}<em parentName=\"p\">{`require`}</em>{` these technology choices and `}<em parentName=\"p\">{`could`}</em>{` actually be used with any database and abstractions over them (raw SQL, query builder, ORM..). However, Nexus is built by a team at Prisma (the company) and unsurprisingly there is great integration between its tools and Nexus.`}</p><section parentName=\"section\"><h2 parentName=\"section\" {...{\n          \"id\": \"prisma\",\n          \"style\": {\n            \"position\": \"relative\"\n          }\n        }}><a parentName=\"h2\" {...{\n            \"href\": \"#prisma\",\n            \"aria-label\": \"prisma permalink\",\n            \"className\": \"title-link before\"\n          }}><svg parentName=\"a\" {...{\n              \"width\": \"17\",\n              \"height\": \"18\",\n              \"viewBox\": \"0 0 17 18\",\n              \"fill\": \"none\",\n              \"xmlns\": \"http://www.w3.org/2000/svg\"\n            }}>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 6.33337H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 11.6666H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M6.75 1L5 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M12 1L10.25 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}</svg></a>{`Prisma?`}</h2><p parentName=\"section\">{`So, what `}<em parentName=\"p\">{`is`}</em>{` Prisma? It is an open source database toolkit that consists of the following parts:`}</p><p parentName=\"section\"><strong parentName=\"p\">{`Prisma Client`}</strong>{`: Auto-generated and type-safe query builder for Node.js & TypeScript\n`}<strong parentName=\"p\">{`Prisma Migrate`}</strong>{` (experimental): Declarative data modeling & migration system\n`}<strong parentName=\"p\">{`Prisma Studio`}</strong>{` (experimental): GUI to view and edit data in your database`}</p><p parentName=\"section\">{`At the heart of Prisma is the `}<em parentName=\"p\">{`Prisma Schema,`}</em>{` a file usually called `}<inlineCode parentName=\"p\">{`schema.prisma`}</inlineCode>{`, that you will see later in this tutorial. It is a declarative file wherein using a domain specific language you encode your database schema, connection to the database, and more.`}</p><p parentName=\"section\">{`Prisma has great `}<a parentName=\"p\" {...{\n            \"href\": \"https://www.prisma.io/docs/understand-prisma/introduction\"\n          }}>{`docs`}</a>{` so definitely check them out at some point. For now you can stay in the flow of this tutorial if you want though. We're going to focus on Prisma Client.`}</p></section><section parentName=\"section\"><h2 parentName=\"section\" {...{\n          \"id\": \"nexus-plugins\",\n          \"style\": {\n            \"position\": \"relative\"\n          }\n        }}><a parentName=\"h2\" {...{\n            \"href\": \"#nexus-plugins\",\n            \"aria-label\": \"nexus plugins permalink\",\n            \"className\": \"title-link before\"\n          }}><svg parentName=\"a\" {...{\n              \"width\": \"17\",\n              \"height\": \"18\",\n              \"viewBox\": \"0 0 17 18\",\n              \"fill\": \"none\",\n              \"xmlns\": \"http://www.w3.org/2000/svg\"\n            }}>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 6.33337H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 11.6666H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M6.75 1L5 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M12 1L10.25 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}</svg></a>{`Nexus plugins?`}</h2><p parentName=\"section\">{`Now we're ready to actually use Prisma with Nexus! This is going to be achieved by way of a Nexus `}<em parentName=\"p\">{`plugin`}</em>{`. What? Yep, Nexus has a plugin ecosystem which can be used to enhance your app and development experience in a number of ways! Nexus Plugins broadly breakdown into three areas of enhancement:`}</p><ol parentName=\"section\">\n          <li parentName=\"ol\"><strong parentName=\"li\">{`worktime:`}</strong>{` watch new file types, hook onto events, attach new CLI commands, ...`}</li>\n          <li parentName=\"ol\"><strong parentName=\"li\">{`runtime:`}</strong>{` add schema middleware, setting presets, field builders, custom scalars, ...`}</li>\n          <li parentName=\"ol\"><strong parentName=\"li\">{`testtime:`}</strong>{` attach data to the Nexus Test Context`}</li>\n        </ol><p parentName=\"section\">{`Plugin packages are usually named after the following convention: `}<inlineCode parentName=\"p\">{`nexus-plugin-<name>`}</inlineCode>{` and we refer to them just by either name suffix part. So for the example when we say that Prisma and Nexus integrate together via the Nexus `}<inlineCode parentName=\"p\">{`prisma`}</inlineCode>{` plugin that means `}<inlineCode parentName=\"p\">{`nexus-plugin-prisma`}</inlineCode>{`.`}</p><p parentName=\"section\">{`Another convention that they usually follow is that they use the default export of the package as well as a named export that is a camel case variant of the name part mentioned before (see below for example).`}</p><p parentName=\"section\">{`Plugins are easy to use:`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`npm add nexus-plugin-foo\n`}</code></pre><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-ts\"\n          }}>{`import foo from 'nexus-plugin-foo'\nimport { foo } from 'nexus-plugin-foo' // alternative, as you wish\nimport { use } from 'nexus'\n\nuse(foo())\n`}</code></pre><p parentName=\"section\">{`All plugins are functions. They can accept optional or required settings if the plugin authors wishes so. Once a plugin is imported and invoked, its return value is passed to the Nexus `}<inlineCode parentName=\"p\">{`use`}</inlineCode>{` method. Once done, your app is using the plugin. On the surface the method looks similar to that of `}<inlineCode parentName=\"p\">{`express`}</inlineCode>{`'s `}<inlineCode parentName=\"p\">{`use`}</inlineCode>{`.`}</p><p parentName=\"section\">{`Note how the plugins only exist within your app code yet we mentioned before that plugins can augment worktime aspects like the CLI. Neat right? No external config files with plugin setup are required. Its one of many examples of how Nexus provides a powerful and extensible system without forwarding you, the user, a complexity tax for it.`}</p></section><section parentName=\"section\"><h2 parentName=\"section\" {...{\n          \"id\": \"connect-to-your-database\",\n          \"style\": {\n            \"position\": \"relative\"\n          }\n        }}><a parentName=\"h2\" {...{\n            \"href\": \"#connect-to-your-database\",\n            \"aria-label\": \"connect to your database permalink\",\n            \"className\": \"title-link before\"\n          }}><svg parentName=\"a\" {...{\n              \"width\": \"17\",\n              \"height\": \"18\",\n              \"viewBox\": \"0 0 17 18\",\n              \"fill\": \"none\",\n              \"xmlns\": \"http://www.w3.org/2000/svg\"\n            }}>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 6.33337H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 11.6666H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M6.75 1L5 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M12 1L10.25 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}</svg></a>{`Connect to your database`}</h2><p parentName=\"section\">{`Now that you know a bit about Prisma and Nexus plugins, let's get going! Do the following:`}</p><ul parentName=\"section\">\n          <li parentName=\"ul\">{`Install the Prisma plugin`}</li>\n          <li parentName=\"ul\">{`Use it in your `}<inlineCode parentName=\"li\">{`api/app.ts`}</inlineCode>{` module`}</li>\n          <li parentName=\"ul\">{`Create your Prisma Schema`}</li>\n          <li parentName=\"ul\">{`Create a `}<inlineCode parentName=\"li\">{`.env`}</inlineCode>{` file to store your database credentials`}</li>\n          <li parentName=\"ul\">{`Connect to your database`}</li>\n        </ul><p parentName=\"section\">{`like so:`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`npm add nexus-plugin-prisma\n`}</code></pre><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-ts\"\n          }}>{`// api/app.ts\n\nimport { use } from 'nexus'\nimport { prisma } from 'nexus-plugin-prisma'\n\nuse(prisma())\n`}</code></pre><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`mkdir prisma\ntouch prisma/schema.prisma\ntouch prisma/.env\n`}</code></pre><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-groovy\"\n          }}>{`// prisma/schema.prisma\n\ndatasource postgres {\n  provider = \"postgresql\"\n  url      = env(\"DATABASE_URL\")\n}\n`}</code></pre><pre parentName=\"section\"><code parentName=\"pre\" {...{}}>{`# prisma/.env\nDATABASE_URL=\"<postgres_connection_url>\"\n`}</code></pre><p parentName=\"section\">{`Almost done, but we still need to setup a Postgres database for our app to connect to. There are a ton of ways to do this so we're just going to show the most straight forward cross-platform way we know how. First, make sure you have `}<a parentName=\"p\" {...{\n            \"href\": \"https://docs.docker.com/get-docker/\"\n          }}>{`docker installed`}</a>{`. Then, simply run this command:`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{}}>{`❯ docker run --detach --publish 5432:5432 -e POSTGRES_PASSWORD=postgres --name postgres postgres:10.12\n`}</code></pre><p parentName=\"section\">{`That's it. You now have a Postgres server running. You can connect to it at a URL like:`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-markdown\"\n          }}>{`postgresql://postgres:postgres@localhost:5432/myapp\n`}</code></pre><p parentName=\"section\">{`If you prefer setting up your local Postgres another way go for it. If our suggest approach doesn't work for you, then checkout a few other approaches listed on the `}<a parentName=\"p\" {...{\n            \"href\": \"https://www.nexusjs.org/#/references/recipes?id=setting-up-postgresql\"\n          }}>{`Nexus recipes page`}</a>{`.`}</p><p parentName=\"section\">{`Finally, in the `}<inlineCode parentName=\"p\">{`prisma/.env`}</inlineCode>{` file you've created before, replace `}<inlineCode parentName=\"p\">{`<postgres_connection_url>`}</inlineCode>{` with your actual database URL.`}</p><p parentName=\"section\">{`Confirm things are setup correctly by ... `}<strong parentName=\"p\">{`TODO: find a way to make sure their connection url is working`}</strong></p></section><section parentName=\"section\"><h2 parentName=\"section\" {...{\n          \"id\": \"create-your-database-schema\",\n          \"style\": {\n            \"position\": \"relative\"\n          }\n        }}><a parentName=\"h2\" {...{\n            \"href\": \"#create-your-database-schema\",\n            \"aria-label\": \"create your database schema permalink\",\n            \"className\": \"title-link before\"\n          }}><svg parentName=\"a\" {...{\n              \"width\": \"17\",\n              \"height\": \"18\",\n              \"viewBox\": \"0 0 17 18\",\n              \"fill\": \"none\",\n              \"xmlns\": \"http://www.w3.org/2000/svg\"\n            }}>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 6.33337H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 11.6666H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M6.75 1L5 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M12 1L10.25 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}</svg></a>{`Create your database schema`}</h2><p parentName=\"section\">{`It is now time to replace our in-memory data with actual tables in our database. To do this we'll write models in our Prisma Schema.`}</p><p parentName=\"section\">{`In chapters 2 and 3 we already began to model our blog domain with the GraphQL type `}<inlineCode parentName=\"p\">{`Post`}</inlineCode>{`. We can base our models on that prior work, resulting in a Prisma Schema like so:`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-groovy\"\n          }}>{`// prisma/schema.prisma\n// ...\n\nmodel Post {\n  id        Int     @id @default(autoincrement())\n  title     String\n  body      String\n  published Boolean\n}\n`}</code></pre><p parentName=\"section\">{`With our database schema specified, we're now ready to proceed to our first database migration! To do that, we'll use the Prisma CLI.`}</p><p parentName=\"section\">{`Generate our migration files...`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`npx prisma migrate save --experimental\n`}</code></pre><p parentName=\"section\">{`Then, apply the migration...`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`npx prisma migrate up --experimental\n`}</code></pre></section><section parentName=\"section\"><h2 parentName=\"section\" {...{\n          \"id\": \"access-your-database\",\n          \"style\": {\n            \"position\": \"relative\"\n          }\n        }}><a parentName=\"h2\" {...{\n            \"href\": \"#access-your-database\",\n            \"aria-label\": \"access your database permalink\",\n            \"className\": \"title-link before\"\n          }}><svg parentName=\"a\" {...{\n              \"width\": \"17\",\n              \"height\": \"18\",\n              \"viewBox\": \"0 0 17 18\",\n              \"fill\": \"none\",\n              \"xmlns\": \"http://www.w3.org/2000/svg\"\n            }}>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 6.33337H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 11.6666H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M6.75 1L5 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M12 1L10.25 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}</svg></a>{`Access your database`}</h2><p parentName=\"section\">{`Now let's finally ditch our in-memory data! Let's start by removing the `}<inlineCode parentName=\"p\">{`api/db.ts`}</inlineCode>{` module and then be guided by TypeScript errors.`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`rm api/db.ts\n`}</code></pre><p parentName=\"section\">{`In `}<inlineCode parentName=\"p\">{`api/app.ts`}</inlineCode>{` module, remove the db import and the `}<inlineCode parentName=\"p\">{`schema.addToContext`}</inlineCode>{` call.`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-diff\"\n          }}>{`+++ api/app.ts\n\n- import { schema, use } from 'nexus'\n+ import { use } from 'nexus'\n  import { prisma } from 'nexus-plugin-prisma'\n- import { db } from './db'\n\n  use(prisma())\n\n- schema.addToContext(() => {\n-   return {\n-     db,\n-   }\n- })\n`}</code></pre><p parentName=\"section\">{`You might be wondering how you'll maintain access to the `}<inlineCode parentName=\"p\">{`db`}</inlineCode>{` client in your GraphQL Context given that we've just deleted it. Nexus plugins help here. One of their many capabilities is augmenting your GraphQL context.`}</p><p parentName=\"section\">{`In this case, the prisma plugin adds a `}<inlineCode parentName=\"p\">{`db`}</inlineCode>{` property, an instance of Prisma Client, one of the tools in the Prisma toolkit.`}</p><p parentName=\"section\">{`Let's now replace all our previous in-memory db interactions with calls to the Prisma Client`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-diff\"\n          }}>{`schema.extendType({\n  type: 'Query',\n  definition(t) {\n    t.list.field('drafts', {\n      type: 'Post',\n      resolve(_root, _args, ctx) {\n-        return ctx.db.posts.filter((p) => p.published === false)\n+        return ctx.db.post.findMany({ where: { published: false } })\n      },\n    });\n    t.list.field('posts', {\n      type: 'Post',\n      resolve(_root, _args, ctx) {\n-       return ctx.db.posts.filter((p) => p.published === true)\n+       return ctx.db.post.findMany({ where: { published: true } })\n      },\n    })\n  },\n});\n`}</code></pre><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-diff\"\n          }}>{`schema.extendType({\n  type: 'Mutation',\n  definition(t) {\n    t.field('createDraft', {\n      type: 'Post',\n      args: {\n        title: schema.stringArg({ required: true }),\n        body: schema.stringArg({ required: true }),\n      },\n      resolve(_root, args, ctx) {\n        const draft = {\n-         id: ctx.inDb.posts.length + 1,\n          title: args.title,\n          body: args.body,\n          published: false,\n        }\n-       ctx.inDb.posts.push(draft)\n\n-       return draft\n+       return ctx.db.post.create({ data: draft })\n      },\n    })\n\n    t.field('publish', {\n      type: 'Post',\n      args: {\n        draftId: schema.intArg({ required: true }),\n      },\n      resolve(_root, args, ctx) {\n-       let postToPublish = ctx.inDb.posts.find((p) => p.id === args.draftId)\n\n-       if (!postToPublish) {\n-         throw new Error('Could not find draft with id ' + args.draftId)\n-       }\n\n-       postToPublish.published = true\n\n-       return postToPublish\n\n+       return ctx.db.post.update({\n+         where: { id: args.draftId },\n+         data: {\n+           published: true,\n+         },\n+       });\n      },\n    })\n  },\n})\n`}</code></pre><p parentName=\"section\">{`If you need a copy & pastable version, here it is`}</p><pre parentName=\"section\"><code parentName=\"pre\" {...{\n            \"className\": \"language-ts\"\n          }}>{`schema.extendType({\n  type: 'Query',\n  definition(t) {\n    t.list.field('drafts', {\n      type: 'Post',\n      resolve(_root, _args, ctx) {\n        return ctx.db.post.findMany({ where: { published: false } })\n      },\n    })\n    t.list.field('posts', {\n      type: 'Post',\n      resolve(_root, _args, ctx) {\n        return ctx.db.post.findMany({ where: { published: true } })\n      },\n    })\n  },\n})\n\nschema.extendType({\n  type: 'Mutation',\n  definition(t) {\n    t.field('createDraft', {\n      type: 'Post',\n      args: {\n        title: schema.stringArg({ required: true }),\n        body: schema.stringArg({ required: true }),\n      },\n      resolve(_root, args, ctx) {\n        const draft = {\n          title: args.title,\n          body: args.body,\n          published: false,\n        }\n        return ctx.db.post.create({ data: draft })\n      },\n    })\n\n    t.field('publish', {\n      type: 'Post',\n      args: {\n        draftId: schema.intArg({ required: true }),\n      },\n      resolve(_root, args, ctx) {\n        return ctx.db.post.update({\n          where: { id: args.draftId },\n          data: {\n            published: true,\n          },\n        })\n      },\n    })\n  },\n})\n`}</code></pre></section><section parentName=\"section\"><h2 parentName=\"section\" {...{\n          \"id\": \"try-it-out\",\n          \"style\": {\n            \"position\": \"relative\"\n          }\n        }}><a parentName=\"h2\" {...{\n            \"href\": \"#try-it-out\",\n            \"aria-label\": \"try it out permalink\",\n            \"className\": \"title-link before\"\n          }}><svg parentName=\"a\" {...{\n              \"width\": \"17\",\n              \"height\": \"18\",\n              \"viewBox\": \"0 0 17 18\",\n              \"fill\": \"none\",\n              \"xmlns\": \"http://www.w3.org/2000/svg\"\n            }}>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 6.33337H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 11.6666H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M6.75 1L5 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M12 1L10.25 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}</svg></a>{`Try It Out`}</h2><p parentName=\"section\">{`Awesome, you're ready to open up the playground and create a draft! If all goes well, good job! If not, no worries, there's a lot of integration pieces in this chapter where something could have gone wrong. If after reviewing your steps you still don't understand the issue, feel free to open up a `}<a parentName=\"p\" {...{\n            \"href\": \"https://nxs.li/discussions\"\n          }}>{`discussion`}</a>{` asking for help.`}</p></section><section parentName=\"section\"><h2 parentName=\"section\" {...{\n          \"id\": \"wrapping-up\",\n          \"style\": {\n            \"position\": \"relative\"\n          }\n        }}><a parentName=\"h2\" {...{\n            \"href\": \"#wrapping-up\",\n            \"aria-label\": \"wrapping up permalink\",\n            \"className\": \"title-link before\"\n          }}><svg parentName=\"a\" {...{\n              \"width\": \"17\",\n              \"height\": \"18\",\n              \"viewBox\": \"0 0 17 18\",\n              \"fill\": \"none\",\n              \"xmlns\": \"http://www.w3.org/2000/svg\"\n            }}>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 6.33337H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M1.5 11.6666H15.5\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M6.75 1L5 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}<path parentName=\"svg\" {...{\n                \"d\": \"M12 1L10.25 17\",\n                \"stroke\": \"#CBD5E0\",\n                \"strokeWidth\": \"2\",\n                \"strokeLineCap\": \"round\",\n                \"strokeLineJoin\": \"round\"\n              }}></path>{`\n      `}</svg></a>{`Wrapping Up`}</h2><p parentName=\"section\">{`We've just changed our code, so we must be due or overdue for a test update right? Well, in the next chapter we'll do just that, and show you how Nexus testing works with Prisma.`}</p><div class=\"NextIs NextChapter\"></div><p parentName=\"section\"><a parentName=\"p\" {...{\n            \"href\": \"/tutorial/chapter-6-testing-with-prisma\"\n          }}>{`➳`}</a></p></section></section>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}